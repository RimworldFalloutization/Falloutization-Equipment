<?xml version="1.0" encoding="utf-8"?>
<Patch>
    <!-- Remove Recon, Marine (Powered), and Cataphract armor research and make those armors uncraftable, uncategorized, and untagged. -->

    <!-- Clear prerequisites that point to removed projects first, then remove research projects -->
    <Operation Class="PatchOperationReplace" MayRequire="Ludeon.RimWorld.Royalty">
        <xpath>Defs/ResearchProjectDef[defName='CataphractArmor']/prerequisites</xpath>
        <value><prerequisites /></value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ResearchProjectDef[defName='PoweredArmor']/prerequisites</xpath>
        <value><prerequisites /></value>
    </Operation>

    <!-- Remove FCP references to removed research projects -->
    <Operation Class="PatchOperationRemove" MayRequire="Rick.FCP.Enclave">
        <xpath>Defs/ResearchProjectDef[defName='FCP_Research_Enclave_Advanced_Equipment']/prerequisites/li[.='PoweredArmor']</xpath>
    </Operation>
    <Operation Class="PatchOperationRemove" MayRequire="Rick.FCP.Core.Tools">
        <xpath>Defs/ResearchProjectDef[defName='FCP_Research_Power_Armor_Applications']/prerequisites/li[.='PoweredArmor']</xpath>
    </Operation>

    <!-- Remove the research projects -->
    <Operation Class="PatchOperationRemove">
        <xpath>Defs/ResearchProjectDef[defName='ReconArmor']</xpath>
    </Operation>
    <Operation Class="PatchOperationRemove">
        <xpath>Defs/ResearchProjectDef[defName='PoweredArmor']</xpath>
    </Operation>
    <Operation Class="PatchOperationRemove" MayRequire="Ludeon.RimWorld.Royalty">
        <xpath>Defs/ResearchProjectDef[defName='CataphractArmor']</xpath>
    </Operation>

    <!-- Remove (Prestige) Recon Armor -->
    <Operation Class="XmlExtensions.ApplyPatch">
        <patchName>Falloutization_Equipment_Remove_Apparel</patchName>
        <arguments>
            <li>Defs/ThingDef[@ParentName='ApparelArmorReconBase']</li>
        </arguments>
    </Operation>

    <!-- Remove (Prestige) Recon Helmet  -->
    <Operation Class="XmlExtensions.ApplyPatch">
        <patchName>Falloutization_Equipment_Remove_Apparel</patchName>
        <arguments>
            <li>Defs/ThingDef[@ParentName='ApparelArmorHelmetReconBase']</li>
        </arguments>
    </Operation>

    <Operation Class="PatchOperationReplace" MayRequire="Rick.FCP.Wastelanders">
        <xpath>Defs/ThingSetMakerDef[defName='MapGen_AncientComplex_SecurityCrate']//li[.='Apparel_ArmorHelmetRecon']</xpath>
        <value>
            <li>FCP_Apparel_Combat_Helmet</li>
            <li>FCP_Apparel_Combat_Armor_Helmet</li>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace" MayRequire="Rick.FCP.Wastelanders">
        <xpath>Defs/ThingSetMakerDef[defName='MapGen_AncientComplex_SecurityCrate']//li[.='Apparel_ArmorHelmetReconPrestige']</xpath>
        <value>
            <li>FCP_Apparel_Reinforced_Combat_Armor_Helmet</li>
            <li>FCP_Apparel_Reinforced_Combat_Armor_Helmet_Mk_II</li>
        </value>
    </Operation>

    <!-- Revmove (Prestige) Powered Armor-->
    <Operation Class="XmlExtensions.ApplyPatch">
        <patchName>Falloutization_Equipment_Remove_Apparel</patchName>
        <arguments>
            <li>Defs/ThingDef[@ParentName='ApparelArmorPowerBase']</li>
        </arguments>
    </Operation>

    <Operation Class="PatchOperationReplace" MayRequire="Rick.FCP.Core.Tools">
        <xpath>Defs/ThingSetMakerDef[defName='MapGen_AncientTempleContents']//li[.='Apparel_PowerArmor']</xpath>
        <value>
            <li>FCP_Apparel_Power_Armor_T45Armor</li>
            <li>FCP_Apparel_Power_Armor_T51Armor</li>
            <li>FCP_Apparel_Power_Armor_T60Armor</li>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace" MayRequire="Ludeon.RimWorld.Odyssey,Rick.FCP.Core.Tools">
        <xpath>Defs/ThingSetMakerDef[defName='MapGen_ScarlandsHermeticCrate']//li[.='Apparel_PowerArmor']</xpath>
        <value>
            <li>FCP_Apparel_Power_Armor_T45Armor</li>
            <li>FCP_Apparel_Power_Armor_T51Armor</li>
            <li>FCP_Apparel_Power_Armor_T60Armor</li>
        </value>
    </Operation>

    <!-- Remove (Prestige) Powered Helmet -->
    <Operation Class="XmlExtensions.ApplyPatch">
        <patchName>Falloutization_Equipment_Remove_Apparel</patchName>
        <arguments>
            <li>Defs/ThingDef[@ParentName='ApparelArmorHelmetPowerBase']</li>
        </arguments>
    </Operation>

    <Operation Class="PatchOperationReplace" MayRequire="Rick.FCP.Core.Tools">
        <xpath>Defs/ThingSetMakerDef[defName='MapGen_AncientTempleContents']//li[.='Apparel_PowerArmorHelmet']</xpath>
        <value>
            <li>FCP_Apparel_Power_Armor_T45_Helmet</li>
            <li>FCP_Apparel_Power_Armor_T51_Helmet</li>
            <li>FCP_Apparel_Power_Armor_T60_Helmet</li>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace" MayRequire="Ludeon.RimWorld.Odyssey,Rick.FCP.Core.Tools">
        <xpath>Defs/ThingSetMakerDef[defName='MapGen_ScarlandsHermeticCrate']//li[.='Apparel_PowerArmorHelmet']</xpath>
        <value>
            <li>FCP_Apparel_Power_Armor_T45_Helmet</li>
            <li>FCP_Apparel_Power_Armor_T51_Helmet</li>
            <li>FCP_Apparel_Power_Armor_T60_Helmet</li>
        </value>
    </Operation>

    <!-- Remove (Prestige) Cataphract Armor and Helmet -->
    <Operation Class="XmlExtensions.ApplyPatch">
        <patchName>Falloutization_Equipment_Remove_Apparel</patchName>
        <arguments>
            <li>Defs/ThingDef[@ParentName='ApparelArmorCataphractBase']</li>
        </arguments>
    </Operation>
    <Operation Class="XmlExtensions.ApplyPatch">
        <patchName>Falloutization_Equipment_Remove_Apparel</patchName>
        <arguments>
            <li>Defs/ThingDef[@ParentName='ApparelArmorHelmetCataphractBase']</li>
        </arguments>
    </Operation>
</Patch>
